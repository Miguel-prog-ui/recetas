<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recetas Favoritas - Recetas Deliciosas</title>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='recetas_favoritas.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo-section">
                    <a href="/acceso_publico" class="home-btn">
                        <span class="home-icon"><i class="fas fa-home"></i></span>
                    </a>
                    <div class="logo-text">Recetas Deliciosas</div>
                </div>
                <div class="header-right">
                    {% if session.usuario %}
                    <div class="user-menu-container">
                        <div class="user-avatar" onclick="toggleUserMenu()">
                            <div class="avatar-circle">
                                <span class="avatar-initial">{{ session.usuario[0] | upper }}</span>
                            </div>
                            <span class="user-name">{{ session.usuario }}</span>
                            <span class="dropdown-arrow"><i class="fas fa-chevron-down"></i></span>
                        </div>
                        <div class="user-dropdown-menu" id="userDropdownMenu">
                            <div class="dropdown-header">
                                <div class="user-info-dropdown">
                                    <div class="avatar-circle small">
                                        <span class="avatar-initial">{{ session.usuario[0] | upper }}</span>
                                    </div>
                                    <div class="user-details">
                                        <span class="welcome-text">Hola, {{ session.usuario }}! 👋</span>
                                        <span class="user-email">{{ usuario[2] if usuario else 'Email no disponible' }}</span>
                                    </div>
                                </div>
                            </div>
                            <div class="dropdown-divider"></div>
                            <a href="{{ url_for('perfil') }}" class="dropdown-item">
                                <span class="item-icon"><i class="fas fa-user"></i></span>
                                <span class="item-text">Mi Perfil</span>
                            </a>
                            <a href="{{ url_for('editar_perfil') }}" class="dropdown-item">
                                <span class="item-icon"><i class="fas fa-cog"></i></span>
                                <span class="item-text">Editar Perfil</span>
                            </a>
                            <a href="{{ url_for('recetas_favoritas') }}" class="dropdown-item">
                                <span class="item-icon"><i class="fas fa-heart"></i></span>
                                <span class="item-text">Recetas Favoritas</span>
                            </a>
                            <a href="{{ url_for('mis_recetas') }}" class="dropdown-item">
                                <span class="item-icon"><i class="fas fa-book"></i></span>
                                <span class="item-text">Mis Recetas</span>
                            </a>
                            <div class="dropdown-divider"></div>
                            <a href="{{ url_for('logout') }}" class="dropdown-item logout-item">
                                <span class="item-icon"><i class="fas fa-sign-out-alt"></i></span>
                                <span class="item-text">Cerrar Sesión</span>
                            </a>
                        </div>
                    </div>
                    {% else %}
                    <a href="{{ url_for('mostrar_login') }}" class="login-btn">Iniciar sesión</a>
                    {% endif %}
                </div>
            </div>
        </div>
    </header>

    <main class="container">
        <section class="hero">
            <div class="hero-content">
                <h1>Tus Recetas Favoritas</h1>
                <p>Aquí encontrarás todas las recetas que has marcado con like</p>
                <div class="stats-bar">
                    <div class="stat-item">
                        <i class="fas fa-heart"></i>
                        <span id="totalFavorites">Cargando...</span>
                    </div>
                    <div class="stat-item">
                        <i class="fas fa-clock"></i>
                        <span id="sortInfo">Ordenado por fecha de like</span>
                    </div>
                </div>
                <div class="hero-decoration">
                    <div class="decoration-item"></div>
                    <div class="decoration-item"></div>
                    <div class="decoration-item"></div>
                </div>
            </div>
        </section>

        <!-- Sección de ordenamiento -->
        <section class="sorting-section">
            <div class="container">
                <div class="sort-options">
                    <label for="sortSelect">Ordenar por:</label>
                    <select id="sortSelect" onchange="changeSortOrder()">
                        <option value="recent">Más recientes primero</option>
                        <option value="oldest">Más antiguas primero</option>
                        <option value="popular">Más populares</option>
                        <option value="title">Título (A-Z)</option>
                        <option value="category">Categoría</option>
                    </select>
                </div>
            </div>
        </section>

        <section class="recipes-section">
            <div class="container">
                <div class="section-header">
                    <h2 class="section-title">Tus Likes</h2>
                    <div class="section-actions">
                        <button class="refresh-btn" onclick="loadFavoriteRecipes()">
                            <i class="fas fa-sync-alt"></i> Actualizar
                        </button>
                    </div>
                </div>
                
                <div id="loadingMessage" class="loading-message">
                    <i class="fas fa-spinner fa-spin"></i>
                    <p>Cargando tus recetas favoritas...</p>
                </div>
                
                <div id="recipesContainer" class="recipes-grid" style="display: none;">
                    <!-- Las recetas con like se cargarán dinámicamente aquí -->
                </div>
                
                <div id="noResultsMessage" class="no-results-message" style="display: none;">
                    <div class="no-results-icon">
                        <i class="fas fa-heart"></i>
                    </div>
                    <h3>Aún no tienes recetas con like</h3>
                    <p>Cuando des like a recetas, aparecerán aquí ordenadas por fecha</p>
                    <a href="/" class="submit-btn">
                        <i class="fas fa-utensils"></i> Explorar Recetas
                    </a>
                </div>
            </div>
        </section>

        <!-- Sección de detalle de receta (oculta inicialmente) -->
        <section id="recipeDetailSection" class="recipe-detail-section" style="display: none;">
            <div class="container">
                <div class="detail-header">
                    <button onclick="hideRecipeDetail()" class="back-btn">
                        <i class="fas fa-arrow-left"></i> Volver a mis favoritas
                    </button>
                    <h2 class="detail-title">Detalle de la Receta</h2>
                </div>
                <div id="recipeDetailContent"></div>
            </div>
        </section>
    </main>

    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-links">
                    <a href="#about">Acerca de</a>
                    <a href="#contact">Contacto</a>
                    <a href="#privacy">Privacidad</a>
                    <a href="#terms">Términos</a>
                </div>
                <p>&copy; 2024 Recetas Deliciosas. Todos los derechos reservados.</p>
            </div>
        </div>
    </footer>

    <script>
        let currentUserId = "{{ session.usuario }}";
        let favoriteRecipes = [];
        let currentSortOrder = 'recent';
        
        // Funciones del menú de usuario
        function toggleUserMenu() {
            const menu = document.getElementById('userDropdownMenu');
            menu.classList.toggle('active');
        }

        document.addEventListener('click', function(event) {
            const userMenu = document.querySelector('.user-menu-container');
            const menu = document.getElementById('userDropdownMenu');
            
            if (userMenu && !userMenu.contains(event.target)) {
                menu.classList.remove('active');
            }
        });

        // Cambiar ordenamiento
        function changeSortOrder() {
            const sortSelect = document.getElementById('sortSelect');
            currentSortOrder = sortSelect.value;
            
            // Actualizar texto informativo
            const sortInfo = document.getElementById('sortInfo');
            const sortTexts = {
                'recent': 'Ordenado por fecha de like (más recientes)',
                'oldest': 'Ordenado por fecha de like (más antiguas)',
                'popular': 'Ordenado por popularidad',
                'title': 'Ordenado por título (A-Z)',
                'category': 'Ordenado por categoría'
            };
            sortInfo.textContent = sortTexts[currentSortOrder] || 'Ordenado por fecha de like';
            
            // Reordenar y mostrar recetas
            sortAndDisplayRecipes();
        }

        // Ordenar y mostrar recetas
        function sortAndDisplayRecipes() {
            if (favoriteRecipes.length === 0) return;
            
            const sortedRecipes = [...favoriteRecipes];
            
            switch(currentSortOrder) {
                case 'recent':
                    sortedRecipes.sort((a, b) => new Date(b.liked_at) - new Date(a.liked_at));
                    break;
                case 'oldest':
                    sortedRecipes.sort((a, b) => new Date(a.liked_at) - new Date(b.liked_at));
                    break;
                case 'popular':
                    sortedRecipes.sort((a, b) => (b.total_likes || 0) - (a.total_likes || 0));
                    break;
                case 'title':
                    sortedRecipes.sort((a, b) => a.title.localeCompare(b.title));
                    break;
                case 'category':
                    sortedRecipes.sort((a, b) => (a.categoria || '').localeCompare(b.categoria || ''));
                    break;
            }
            
            displayFavoriteRecipes(sortedRecipes);
        }

        // Cargar recetas favoritas
        async function loadFavoriteRecipes() {
            if (!currentUserId) {
                showNoResults();
                return;
            }

            showLoading();
            
            try {
                const response = await fetch(`/recetas_con_like?user_id=${encodeURIComponent(currentUserId)}`);
                const data = await response.json();
                
                if (data.success && data.recetas && data.recetas.length > 0) {
                    favoriteRecipes = data.recetas;
                    sortAndDisplayRecipes();
                    document.getElementById('totalFavorites').textContent = `${data.recetas.length} recetas con like`;
                } else {
                    showNoResults();
                    document.getElementById('totalFavorites').textContent = '0 recetas con like';
                }
            } catch (error) {
                console.error('Error al cargar recetas favoritas:', error);
                showNoResults();
                document.getElementById('totalFavorites').textContent = 'Error al cargar';
            }
        }

        // Mostrar recetas favoritas
        function displayFavoriteRecipes(recetas) {
            const container = document.getElementById('recipesContainer');
            const noResults = document.getElementById('noResultsMessage');
            const loading = document.getElementById('loadingMessage');
            
            loading.style.display = 'none';
            noResults.style.display = 'none';
            
            container.innerHTML = recetas.map(receta => `
                <div class="recipe-card" data-recipe-id="${receta.id}">
                    <div class="recipe-image">
                        ${receta.imagen ? `
                            <img src="${receta.imagen}" alt="${receta.title}" 
                                 onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';"
                                 onload="handleImageLoad(this)">
                            <div class="recipe-placeholder" style="display: none;">
                                <i class="fas fa-utensils"></i>
                            </div>
                        ` : `
                            <div class="recipe-placeholder">
                                <i class="fas fa-utensils"></i>
                            </div>
                        `}
                        <div class="favorite-badge active">
                            <i class="fas fa-heart"></i>
                        </div>
                        <div class="recipe-category">
                            <span>${receta.categoria || 'General'}</span>
                        </div>
                        <div class="like-date">
                            <i class="far fa-clock"></i> ${formatLikeDate(receta.liked_at)}
                        </div>
                    </div>
                    <div class="recipe-content">
                        <h4>${receta.title}</h4>
                        <div class="recipe-meta">
                            <span class="likes-count">
                                <i class="fas fa-heart"></i> ${receta.total_likes || 0} likes
                            </span>
                            <span class="time-info">
                                <i class="far fa-calendar"></i> Like el ${formatShortDate(receta.liked_at)}
                            </span>
                        </div>
                        <p class="recipe-description">${receta.ingredients ? (receta.ingredients.substring(0, 100) + (receta.ingredients.length > 100 ? '...' : '')) : 'Descripción no disponible'}</p>
                        
                        <div class="recipe-actions">
                            <button class="action-btn view-btn" onclick="showRecipeDetail('${receta.id}')">
                                <i class="fas fa-eye"></i> Ver Receta
                            </button>
                            <button class="action-btn remove-like-btn" onclick="removeLike('${receta.id}', this)">
                                <i class="fas fa-heart-broken"></i> Quitar Like
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
            
            container.style.display = 'grid';
            
            // Animación para las tarjetas
            const recipeCards = container.querySelectorAll('.recipe-card');
            recipeCards.forEach((card, index) => {
                card.style.opacity = '0';
                card.style.transform = 'translateY(20px)';
                setTimeout(() => {
                    card.style.transition = 'all 0.5s ease';
                    card.style.opacity = '1';
                    card.style.transform = 'translateY(0)';
                }, 100 * index);
            });
        }

        // Manejar carga de imágenes
        function handleImageLoad(img) {
            // Asegurar que todas las imágenes tengan el mismo tamaño
            img.style.width = '100%';
            img.style.height = '100%';
            img.style.objectFit = 'cover';
        }

        // Mostrar detalle completo de la receta
        async function showRecipeDetail(recipeId) {
            const receta = favoriteRecipes.find(r => r.id == recipeId);
            
            if (!receta) return;

            // Ocultar la sección principal y mostrar el detalle
            document.querySelector('.recipes-section').style.display = 'none';
            document.querySelector('.sorting-section').style.display = 'none';
            document.querySelector('.hero').style.display = 'none';
            document.getElementById('recipeDetailSection').style.display = 'block';
            
            // Obtener información actualizada de likes
            const likesInfo = await getLikesInfo(recipeId);
            
            const recipeDetailContent = document.getElementById('recipeDetailContent');
            
            // Procesar ingredientes y pasos
            const ingredientesHTML = receta.ingredients ? 
                receta.ingredients.split('\n')
                    .filter(ing => ing.trim())
                    .map(ing => `<li class="ingredient-item">${ing.trim()}</li>`)
                    .join('') : 
                '<li class="ingredient-item">No hay ingredientes disponibles</li>';
            
            const pasosHTML = receta.steps ? 
                receta.steps.split('\n')
                    .filter(paso => paso.trim())
                    .map((paso, index) => `
                        <div class="step-item">
                            <div class="step-number">${index + 1}</div>
                            <div class="step-content">${paso.trim()}</div>
                        </div>
                    `)
                    .join('') : 
                '<div class="step-item"><div class="step-content">No hay instrucciones disponibles</div></div>';
            
            recipeDetailContent.innerHTML = `
                <div class="recipe-detail-card">
                    <div class="recipe-detail-header">
                        <div class="recipe-title-section">
                            <h2 class="recipe-title-main">${receta.title}</h2>
                            <div class="recipe-header-meta">
                                <span class="recipe-category-badge-large">${receta.categoria || 'General'}</span>
                                <div class="recipe-stats">
                                    <span class="stat-badge">
                                        <i class="fas fa-heart"></i> ${likesInfo.total_likes} likes
                                    </span>
                                    <span class="stat-badge">
                                        <i class="far fa-calendar"></i> ${formatShortDate(receta.liked_at)}
                                    </span>
                                </div>
                            </div>
                        </div>
                        <div class="recipe-detail-actions">
                            <button class="like-btn-detail ${likesInfo.user_liked ? 'liked' : ''}" 
                                    onclick="toggleLikeDetail('${recipeId}', this)">
                                <i class="${likesInfo.user_liked ? 'fas' : 'far'} fa-heart"></i>
                                <span class="like-count">${likesInfo.total_likes}</span>
                            </button>
                        </div>
                    </div>
                    
                    <div class="recipe-image-container">
                        ${receta.imagen ? `
                        <img src="${receta.imagen}" alt="${receta.title}" class="recipe-detail-image"
                             onerror="this.style.display='none'; document.getElementById('imagePlaceholder').style.display='flex';">
                        ` : ''}
                        <div id="imagePlaceholder" class="recipe-detail-image placeholder" ${receta.imagen ? 'style="display: none;"' : ''}>
                            <i class="fas fa-utensils"></i>
                            <p>Imagen no disponible</p>
                        </div>
                    </div>
                    
                    <div class="recipe-detail-content">
                        <div class="content-grid">
                            <div class="ingredients-section">
                                <div class="section-header-detailed">
                                    <h3><i class="fas fa-list-check"></i> Ingredientes</h3>
                                    <span class="section-count">${receta.ingredients ? receta.ingredients.split('\n').filter(ing => ing.trim()).length : 0} items</span>
                                </div>
                                <div class="ingredients-card">
                                    <ul class="ingredients-list-detailed">
                                        ${ingredientesHTML}
                                    </ul>
                                </div>
                            </div>
                            
                            <div class="instructions-section">
                                <div class="section-header-detailed">
                                    <h3><i class="fas fa-mortar-pestle"></i> Preparación</h3>
                                    <span class="section-count">${receta.steps ? receta.steps.split('\n').filter(paso => paso.trim()).length : 0} pasos</span>
                                </div>
                                <div class="steps-card">
                                    <div class="steps-list-detailed">
                                        ${pasosHTML}
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="recipe-footer">
                            <div class="recipe-notes">
                                <h4><i class="fas fa-info-circle"></i> Información</h4>
                                <p>Receta marcada con like el ${formatFullDate(receta.liked_at)}</p>
                                ${receta.url ? `<p><strong>Fuente:</strong> <a href="${receta.url}" target="_blank" class="source-link">Ver receta original</a></p>` : ''}
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Ocultar detalle de receta y volver a la lista
        function hideRecipeDetail() {
            document.getElementById('recipeDetailSection').style.display = 'none';
            document.querySelector('.recipes-section').style.display = 'block';
            document.querySelector('.sorting-section').style.display = 'block';
            document.querySelector('.hero').style.display = 'block';
        }

        // Toggle like desde el detalle
        async function toggleLikeDetail(recipeId, button) {
            if (!currentUserId) {
                alert('Debes iniciar sesión para dar like');
                return;
            }

            try {
                const response = await fetch('/toggle_like', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        recipe_id: recipeId,
                        user_id: currentUserId
                    })
                });

                const data = await response.json();
                
                if (data.success) {
                    const likeIcon = button.querySelector('i');
                    const likeCountSpan = button.querySelector('.like-count');
                    
                    if (data.user_liked) {
                        likeIcon.className = 'fas fa-heart';
                        button.classList.add('liked');
                    } else {
                        likeIcon.className = 'far fa-heart';
                        button.classList.remove('liked');
                        // Si quitó el like, volver a la lista
                        setTimeout(() => {
                            hideRecipeDetail();
                            loadFavoriteRecipes();
                        }, 1000);
                    }
                    
                    likeCountSpan.textContent = data.total_likes;
                    
                    // Actualizar en la lista principal si está visible
                    updateAllLikeButtons(recipeId, data.user_liked, data.total_likes);
                }
            } catch (error) {
                console.error('Error al dar like:', error);
            }
        }

        // Obtener información de likes
        async function getLikesInfo(recipeId) {
            try {
                const response = await fetch(`/likes_receta?recipe_id=${recipeId}&user_id=${currentUserId}`);
                const data = await response.json();
                return data;
            } catch (error) {
                return { total_likes: 0, user_liked: false };
            }
        }

        // Actualizar todos los botones de like
        function updateAllLikeButtons(recipeId, userLiked, totalLikes) {
            const allLikeButtons = document.querySelectorAll(`.like-btn[data-recipe-id="${recipeId}"]`);
            allLikeButtons.forEach(button => {
                const likeIcon = button.querySelector('i');
                const likeCountSpan = button.querySelector('.like-count');
                
                if (userLiked) {
                    likeIcon.className = 'fas fa-heart';
                    button.classList.add('liked');
                } else {
                    likeIcon.className = 'far fa-heart';
                    button.classList.remove('liked');
                }
                
                if (likeCountSpan) {
                    likeCountSpan.textContent = totalLikes;
                }
            });
        }

        // Formatear fechas
        function formatLikeDate(dateString) {
            if (!dateString) return 'Fecha no disponible';
            const date = new Date(dateString);
            const now = new Date();
            const diffTime = Math.abs(now - date);
            const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
            const diffHours = Math.floor(diffTime / (1000 * 60 * 60));
            const diffMinutes = Math.floor(diffTime / (1000 * 60));
            
            if (diffMinutes < 60) return `Hace ${diffMinutes} min`;
            if (diffHours < 24) return `Hace ${diffHours} h`;
            if (diffDays === 1) return 'Ayer';
            if (diffDays < 7) return `Hace ${diffDays} días`;
            return date.toLocaleDateString('es-ES');
        }

        function formatShortDate(dateString) {
            if (!dateString) return '--';
            return new Date(dateString).toLocaleDateString('es-ES');
        }

        function formatFullDate(dateString) {
            if (!dateString) return '--';
            return new Date(dateString).toLocaleDateString('es-ES', {
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
        }

        // Quitar like
        async function removeLike(recipeId, button) {
            if (!currentUserId) {
                alert('Debes iniciar sesión');
                return;
            }

            if (!confirm('¿Estás seguro de que quieres quitar el like de esta receta?')) {
                return;
            }

            try {
                const response = await fetch('/toggle_like', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        recipe_id: recipeId,
                        user_id: currentUserId
                    })
                });

                const data = await response.json();
                
                if (data.success && !data.user_liked) {
                    // Remover la tarjeta de la vista
                    const card = button.closest('.recipe-card');
                    card.style.transition = 'all 0.3s ease';
                    card.style.opacity = '0';
                    card.style.transform = 'translateX(-100%)';
                    
                    setTimeout(() => {
                        card.remove();
                        // Actualizar lista
                        favoriteRecipes = favoriteRecipes.filter(r => r.id != recipeId);
                        // Recargar si no quedan recetas
                        const remainingCards = document.querySelectorAll('.recipe-card');
                        if (remainingCards.length === 0) {
                            showNoResults();
                        }
                        // Actualizar contador
                        document.getElementById('totalFavorites').textContent = `${remainingCards.length} recetas con like`;
                    }, 300);
                } else {
                    alert('Error al quitar like');
                }
            } catch (error) {
                console.error('Error al quitar like:', error);
                alert('Error al procesar la solicitud');
            }
        }

        // Mostrar loading
        function showLoading() {
            document.getElementById('loadingMessage').style.display = 'block';
            document.getElementById('recipesContainer').style.display = 'none';
            document.getElementById('noResultsMessage').style.display = 'none';
        }

        // Mostrar mensaje de no resultados
        function showNoResults() {
            document.getElementById('loadingMessage').style.display = 'none';
            document.getElementById('recipesContainer').style.display = 'none';
            document.getElementById('noResultsMessage').style.display = 'block';
        }

        // Cargar recetas favoritas al iniciar
        document.addEventListener('DOMContentLoaded', function() {
            loadFavoriteRecipes();
        });
    </script>

    <style>
        .stats-bar {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin: 1.5rem 0;
        }

        .stat-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            background: rgba(255, 255, 255, 0.1);
            padding: 0.75rem 1.5rem;
            border-radius: 50px;
            backdrop-filter: blur(10px);
        }

        .stat-item i {
            color: #ff6b6b;
        }

        .sorting-section {
            background: var(--white);
            padding: 20px;
            border-radius: var(--border-radius);
            margin: 20px 0;
            box-shadow: var(--shadow);
        }

        .sort-options {
            display: flex;
            align-items: center;
            gap: 15px;
            justify-content: center;
        }

        .sort-options label {
            font-weight: bold;
            color: var(--dark-color);
        }

        .sort-options select {
            padding: 10px 15px;
            border: 2px solid var(--secondary-color);
            border-radius: 25px;
            background: var(--white);
            color: var(--dark-color);
            font-size: 1rem;
            cursor: pointer;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }

        .refresh-btn {
            background: #4ecdc4;
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .refresh-btn:hover {
            background: #45b8b0;
            transform: translateY(-2px);
        }

        .loading-message {
            text-align: center;
            padding: 3rem;
            color: #666;
        }

        .loading-message i {
            font-size: 2rem;
            margin-bottom: 1rem;
        }

        .like-date {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 15px;
            font-size: 0.8rem;
        }

        .remove-like-btn {
            background: #ff6b6b !important;
        }

        .remove-like-btn:hover {
            background: #ff5252 !important;
        }

        /* Estilos mejorados para el detalle de receta - Versión más profesional */
        .detail-header {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #e8e8e8;
        }

        .detail-title {
            color: var(--primary-color);
            margin: 0;
            font-size: 1.8rem;
            font-weight: 600;
        }

        .back-btn {
            padding: 12px 25px;
            background-color: #6c757d;
            color: var(--white);
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 500;
            transition: var(--transition);
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-size: 0.95rem;
        }

        .back-btn:hover {
            background-color: #5a6268;
            transform: translateY(-2px);
        }

        /* Header del detalle de receta mejorado */
        .recipe-detail-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 25px;
            padding: 25px;
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-radius: 15px;
            border-left: 4px solid var(--primary-color);
        }

        .recipe-title-section {
            flex: 1;
        }

        .recipe-title-main {
            color: var(--dark-color);
            margin: 0 0 15px 0;
            font-size: 2.2rem;
            font-weight: 700;
            line-height: 1.2;
        }

        .recipe-header-meta {
            display: flex;
            align-items: center;
            gap: 20px;
            flex-wrap: wrap;
        }

        .recipe-category-badge-large {
            background: var(--primary-color);
            color: white;
            padding: 8px 20px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .recipe-stats {
            display: flex;
            gap: 15px;
        }

        .stat-badge {
            background: white;
            color: var(--dark-color);
            padding: 6px 15px;
            border-radius: 15px;
            font-size: 0.85rem;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .recipe-detail-actions {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .like-btn-detail {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 25px;
            padding: 12px 24px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            color: #666;
            font-size: 1rem;
            font-weight: 600;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .like-btn-detail:hover {
            border-color: #ff4757;
            color: #ff4757;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .like-btn-detail.liked {
            background-color: #ff4757;
            border-color: #ff4757;
            color: white;
        }

        /* Contenedor de imagen mejorado */
        .recipe-image-container {
            width: 100%;
            height: 400px;
            border-radius: 15px;
            overflow: hidden;
            margin: 25px 0;
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
            position: relative;
        }

        .recipe-detail-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s ease;
        }

        .recipe-detail-image.placeholder {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #f0f0f0, #e0e0e0);
            color: #999;
            font-size: 4rem;
        }

        .recipe-detail-image.placeholder p {
            font-size: 1.1rem;
            margin-top: 15px;
            color: #666;
        }

        /* Grid de contenido mejorado */
        .content-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 30px 0;
        }

        @media (max-width: 768px) {
            .content-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Secciones de ingredientes y preparación mejoradas */
        .ingredients-section, .instructions-section {
            background: white;
            border-radius: 15px;
            padding: 0;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
            border: 1px solid #f0f0f0;
            overflow: hidden;
        }

        .section-header-detailed {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 25px;
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-bottom: 1px solid #e8e8e8;
        }

        .section-header-detailed h3 {
            color: var(--dark-color);
            margin: 0;
            font-size: 1.3rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-count {
            background: var(--primary-color);
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .ingredients-card, .steps-card {
            max-height: 400px;
            overflow-y: auto;
            padding: 20px 25px;
        }

        .ingredients-list-detailed {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .ingredient-item {
            padding: 12px 0;
            border-bottom: 1px solid #f5f5f5;
            font-size: 1rem;
            line-height: 1.5;
            color: #555;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: background-color 0.2s ease;
        }

        .ingredient-item:before {
            content: "•";
            color: var(--primary-color);
            font-weight: bold;
            font-size: 1.2rem;
        }

        .ingredient-item:hover {
            background-color: #f8f9fa;
            border-radius: 5px;
            padding-left: 10px;
            padding-right: 10px;
        }

        .ingredient-item:last-child {
            border-bottom: none;
        }

        .steps-list-detailed {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .step-item {
            display: flex;
            gap: 15px;
            align-items: flex-start;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 3px solid var(--primary-color);
            transition: transform 0.2s ease;
        }

        .step-item:hover {
            transform: translateX(5px);
            background: #e9ecef;
        }

        .step-number {
            background: var(--primary-color);
            color: white;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            flex-shrink: 0;
            font-size: 0.9rem;
        }

        .step-content {
            flex: 1;
            font-size: 1rem;
            line-height: 1.6;
            color: #555;
        }

        /* Footer de la receta */
        .recipe-footer {
            margin-top: 30px;
        }

        .recipe-notes {
            background: #fff9e6;
            padding: 25px;
            border-radius: 15px;
            border-left: 4px solid #ffd700;
        }

        .recipe-notes h4 {
            color: #b8860b;
            margin-bottom: 15px;
            font-size: 1.2rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .recipe-notes p {
            margin: 8px 0;
            color: #666;
            line-height: 1.5;
        }

        .source-link {
            color: var(--primary-color);
            text-decoration: none;
            font-weight: 500;
        }

        .source-link:hover {
            text-decoration: underline;
        }

        /* Mejoras para las imágenes en las tarjetas */
        .recipe-image {
            height: 220px;
            position: relative;
            overflow: hidden;
        }

        .recipe-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }

        .recipe-card:hover .recipe-image img {
            transform: scale(1.05);
        }

        .recipe-placeholder {
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 3rem;
        }
    </style>
</body>
</html>